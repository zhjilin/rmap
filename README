README


INTRODUCTION

This code enables a relatively fast mapping of structured RNA Binding Protein(RBP) binding motifs to a large genome set.
However, it used a primitive algorithm to examine scores of all the loci in the given sequence.
Any N occurs in the sub-sequence are not considered, therefore, there are might be some boundary effect.

Two modes can be used for 1) calculation of kmer count-score table 2) search the potential positions in the sequence with high score.
By default the program will perform the task 2), which gives scores to all possible locus. One can switch to the kmer count-score mode by using '-f'.
Keep in mind, it will yield a massive text file if you run it for the whole genome. It might be useful to filter position with low scores.


DEPENDENCY

The code relies on the following libraries

1) BOOST
https://www.boost.org
2) kseq.h from Heng Li
https://github.com/attractivechaos/klib/blob/master/kseq.h

COMPILING

In order to compile this program, one needs:

for mac:
>=clang-800.0.42.1
>=106300

for linux:
>=g++ 4.4.7
>=105900

g++ -std=c++11 main.cpp -o rmap -lboost_program_options -lz

This will generate a binary file 'rmap' in the current folder'

INSTALLATION

The binary file rmap can be placed anywhere after compiling successfully.

ACKNOWLEDGEMENTS

I appreciate the help from Andreas for discussion and previous


USAGE

rmap --help
Usage:rmap [options]

Allowed options:
--help                 produce help message
--fasta arg            input file
--list arg             specify a list of motifs
--motif arg            specify one motif file
-k [ --kmer ] arg (=8) specify the kmer length
-g [ --gap ] arg (=0)  specify the kmer length
-f [ --kmerflag ]      flag to switch to the kmer counting-score procedure
-r [ --revcomp ]       reverse complement sequence
-o [ --output ]        output the kmer count-score
-c [ --corr ]          output the correlation



the example command to run the program:

for one motif

./rmap -r -k 8 -g 10 --fasta test.fa --motif rbp.matrix


or for a list of motifs
./rmap -r -k 8 -g 10 --fasta test.fa --motif list.rbp.txt



The major scripts used to perform the visualization were deposited in the directory Scripts-HTR

1.VennDiagram

The table were downloaded with the following parameter from CISBP-RNA
The R script used to prepare the figures

2. Family distribution

RNAcompete and RNA bind-n-seq were combined with HT RNA-SELEX data to indicate the coverage of RBPs with motif characterized in each RBP family


3. Length distribution of structured motifs (STEM and LOOP separately)

4. Visualization of the structured motifs


